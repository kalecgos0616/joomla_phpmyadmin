/*
* File: plugin.min.js (for myjsplytebox tinymce plugin)
* Author: Bernard saulmé
* Update: softs.saulme.fr 12/10/2013 (for Tinymce 4)
* License: GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html
*/

tinymce.PluginManager.add("myjsplytebox",
	function(e, url){
	e.addButton("myjsplytebox",{
		title: "Lytebox effect",
		image: url+"/img/myjsplytebox.gif",
		stateSelector: "img:not([data-mce-object])",
		onclick: function() {
			if (e.selection.getNode().nodeName == "IMG"){
				ia = e.dom.getParent(e.selection.getNode(),"a");
				ip = e.selection.getNode().src;
				h = e.selection.getNode().height;
				w = e.selection.getNode().width;
				if (!ia)
					ia = ip;

				e.focus();
				e.selection.setContent('<a href="'+ia+'" rel="lytebox[group]" class="lytebox" data-lyte-options="slide:true group:page"><img src="'+ip+'" height="'+h+'" width="'+w+'" ></a>');
			}
		}
	}),
	e.addMenuItem("myjsplytebox",{text: "Lytebox effect",cmd: "mceMyjsplytebox",context: "tools"})});
